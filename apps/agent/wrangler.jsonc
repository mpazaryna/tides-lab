{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "tides-agent",
  "main": "src/index.ts", 
  "compatibility_date": "2025-06-17",
  
  "account_id": "01bfa3fc31e4462e21428e9ca7d63e98",

  // Workers Logs configuration
  "observability": {
    "enabled": true,
    "head_sampling_rate": 1
  },

  // Default environment configuration
  "durable_objects": {
    "bindings": [
      {
        "name": "COORDINATOR",
        "class_name": "Coordinator"
      }
    ]
  },

  "migrations": [
    {
      "tag": "v1-agent-coordinator",
      "new_classes": ["Coordinator"]
    }
  ],

  // Environment: 101 (Clean Test Environment)
  "env": {
    "101": {
      "name": "tides-agent-101",
      // D1 Database binding
      "d1_databases": [
        {
          "binding": "DB",
          "database_name": "tides-101-db",
          "database_id": "0883f97a-2b95-4247-916d-04d021a739c2"
        }
      ],

      // KV namespace for authentication
      "kv_namespaces": [
        {
          "binding": "TIDES_AUTH_KV",
          "id": "28b1be3455f847079eb0ca5d75bacf13"
        }
      ],

      // R2 bucket for tide storage
      "r2_buckets": [
        {
          "binding": "TIDES_R2",
          "bucket_name": "tides-001-storage"
        }
      ],

      // Durable Objects
      "durable_objects": {
        "bindings": [
          {
            "name": "COORDINATOR",
            "class_name": "Coordinator"
          }
        ]
      },

      // Migrations for environment 101
      "migrations": [
        {
          "tag": "v101-agent-coordinator",
          "new_sqlite_classes": ["Coordinator"]
        }
      ],

      // AI binding for Workers AI
      "ai": {
        "binding": "AI"
      },

      // Environment variables
      "vars": {
        "CLOUDFLARE_ACCOUNT_ID": "01bfa3fc31e4462e21428e9ca7d63e98",
        "R2_BUCKET_NAME": "tides-101-storage",
        "ENVIRONMENT": "clean-test"
      }
    },

    "102": {
      "name": "tides-agent-102",
      // D1 Database binding - Staging (aligned with server env 006)
      "d1_databases": [
        {
          "binding": "DB",
          "database_name": "tides-006-db", 
          "database_id": "a152ac95-647e-4260-9af1-77fbcec16e47"
        }
      ],

      // KV namespace for authentication - Staging (aligned with server env 006)
      "kv_namespaces": [
        {
          "binding": "TIDES_AUTH_KV",
          "id": "c4ec43a892e64119a2f7665897144560"
        }
      ],

      // R2 bucket for tide storage - Staging (aligned with server env 006)
      "r2_buckets": [
        {
          "binding": "TIDES_R2",
          "bucket_name": "tides-006-storage"
        }
      ],

      // Durable Objects - Staging
      "durable_objects": {
        "bindings": [
          {
            "name": "COORDINATOR",
            "class_name": "Coordinator"
          }
        ]
      },

      // Migrations for environment 102
      "migrations": [
        {
          "tag": "v102-agent-coordinator",
          "new_sqlite_classes": ["Coordinator"]
        }
      ],

      // AI binding for Workers AI - Staging
      "ai": {
        "binding": "AI"
      },

      // Environment variables - Staging
      "vars": {
        "CLOUDFLARE_ACCOUNT_ID": "01bfa3fc31e4462e21428e9ca7d63e98",
        "R2_BUCKET_NAME": "tides-006-storage",
        "ENVIRONMENT": "staging"
      }
    },

    "103": {
      "name": "tides-agent-103",
      // D1 Database binding - Development (pointing to 003 worker DB)
      "d1_databases": [
        {
          "binding": "DB",
          "database_name": "tides-003-db",
          "database_id": "74b20aee-081d-4a09-af95-be55470fe4f0"
        }
      ],

      // KV namespace for authentication - Development  
      "kv_namespaces": [
        {
          "binding": "TIDES_AUTH_KV",
          "id": "c4ec43a892e64119a2f7665897144560"
        }
      ],

      // R2 bucket for tide storage - Development (pointing to 003 storage)
      "r2_buckets": [
        {
          "binding": "TIDES_R2",
          "bucket_name": "tides-003-storage"
        }
      ],

      // Durable Objects - Development
      "durable_objects": {
        "bindings": [
          {
            "name": "COORDINATOR",
            "class_name": "Coordinator"
          }
        ]
      },

      // Migrations for environment 103
      "migrations": [
        {
          "tag": "v103-agent-coordinator", 
          "new_sqlite_classes": ["Coordinator"]
        }
      ],

      // AI binding for Workers AI - Development
      "ai": {
        "binding": "AI"
      },

      // Environment variables - Development
      "vars": {
        "CLOUDFLARE_ACCOUNT_ID": "01bfa3fc31e4462e21428e9ca7d63e98",
        "R2_BUCKET_NAME": "tides-003-storage",
        "ENVIRONMENT": "development"
      }
    }
  }
}