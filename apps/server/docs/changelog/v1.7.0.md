# v1.7.0 - 2025-08-11

**Monorepo Integration & Package Management Migration**

This release marks the complete integration of the Tides server into the monorepo structure with comprehensive package management migration and configuration standardization.

## Major Changes

### Added

- **Monorepo Integration** (f4b23a9)
  - Added shared API client (`src/services/apiClient.ts`) for cross-application communication
  - Added shared API types (`src/types/api-types.ts`) for consistent data structures
  - Added environment template (`.env.example`) for development setup
  - Complete monorepo documentation and shared templates distribution

- **Complete Codebase Integration** (7c3a376)
  - Full subtree merge of standalone server into monorepo structure
  - All 176+ files properly integrated under `apps/server/`
  - Preserved complete git history and documentation
  - Maintained all existing functionality and test coverage

### Changed

- **Package Management Migration** (355dc24)
  - **BREAKING**: Migrated from pnpm to npm as primary package manager
  - Updated all documentation references to use `npm` commands
  - Updated monitoring scripts to use npm instead of pnpm
  - Updated deployment and setup scripts for npm compatibility
  - Removed `pnpm-lock.yaml` (4,602 lines removed)
  - Updated CI/CD references in all documentation files

- **Wrangler Configuration Format** (832a552, f1f7ac8)
  - **BREAKING**: Migrated from `wrangler.toml` to `wrangler.jsonc`
  - Enhanced configuration with JSON commenting support
  - Improved readability and maintainability
  - All 262 configuration lines migrated to new format
  - Updated all documentation to reference `.jsonc` format

### Removed

- **Development Server Cleanup** (e7b2ae7)
  - Removed Mason's test server references from `package.json`
  - Cleaned up development-specific server configurations
  - Removed 6 lines of test server scripts

- **Legacy Package Management** (355dc24)
  - Removed `pnpm-lock.yaml` (4,602 lines)
  - Removed all pnpm references from documentation
  - Removed yarn references from setup scripts
  - Cleaned up legacy package manager configurations

## Technical Details

### Package Management Migration

This version completes the migration from pnpm to npm across the entire server codebase:

**Files Updated (16 total)**:

- `CLAUDE.md` - Updated development commands and package manager references
- `CONSOLIDATION_SUMMARY.md` - Updated build and deployment instructions
- `CONTRIBUTING.md` - Updated contributor guidelines for npm usage
- `README.md` - Updated quick start and installation instructions
- `docs/deployments.md` - Updated deployment scripts and commands
- `docs/guides/environments-and-testing.md` - Updated testing commands
- `docs/guides/multi-user-deployments.md` - Updated deployment procedures
- `scripts/monitoring/simple-monitor.js` - Updated monitoring script references
- `scripts/setup/setup-environments.sh` - Updated environment setup scripts

### Configuration Migration

**Wrangler Configuration**:

- Converted TOML format to JSONC for better IDE support
- Added commenting capabilities for better documentation
- Maintained all existing environment configurations (001, 002, 003)
- Preserved all D1 database and R2 storage bindings

### Monorepo Integration

**New Shared Components**:

```typescript
// src/services/apiClient.ts - 56 lines
export interface ApiClientConfig {
  baseUrl: string;
  timeout?: number;
}

// src/types/api-types.ts - 43 lines
export interface TideData {
  id: string;
  title: string;
  // ... complete type definitions
}
```

**Environment Template**:

```bash
# .env.example - 17 lines
CLOUDFLARE_API_TOKEN=your_api_token_here
SUPABASE_URL=your_supabase_url
# ... complete environment setup
```

## Migration Guide

### For Existing Deployments

1. **Package Manager Update**:

   ```bash
   # Remove old lock files
   rm pnpm-lock.yaml

   # Install with npm
   npm install
   ```

2. **Configuration Update**:

   ```bash
   # Update wrangler commands to use .jsonc
   wrangler deploy --config wrangler.jsonc
   ```

3. **Documentation References**:
   - All commands now use `npm run` instead of `pnpm run`
   - Configuration file is now `wrangler.jsonc` instead of `wrangler.toml`

### For New Deployments

Follow the updated installation instructions in `README.md` which now use npm exclusively.

## Compatibility

- **Node.js**: Continues to support Node.js 18+
- **Wrangler**: Compatible with Wrangler 4.26.0+
- **MCP SDK**: Maintained compatibility with @modelcontextprotocol/sdk 1.17.0
- **Cloudflare Workers**: Full compatibility maintained

## Breaking Changes

1. **Package Manager**: Projects must now use npm instead of pnpm
2. **Configuration Format**: `wrangler.toml` replaced with `wrangler.jsonc`
3. **Script Commands**: All npm scripts updated for npm compatibility

## Performance Impact

- **Bundle Size**: No impact on deployed bundle size
- **Development**: Faster development setup with standardized tooling
- **Deployment**: Consistent deployment process across monorepo

## Statistics

- **Files Changed**: 20 files across configuration, documentation, and core code
- **Lines Added**: 378 lines (shared services, types, templates)
- **Lines Removed**: 4,756 lines (primarily pnpm-lock.yaml removal)
- **Net Impact**: Significant reduction in repository size while adding functionality

## Next Steps

This release prepares the foundation for:

- Enhanced cross-application communication via shared API client
- Consistent development experience across all monorepo applications
- Streamlined deployment processes with unified configuration

---

**Full Commit Range**: [7c3a376...355dc24](https://github.com/masonomara/tides/compare/7c3a376...355dc24)

**Contributors**: Mason O'Mara <mason.omara@gmail.com>

_This release completes the monorepo integration milestone and establishes the foundation for enhanced multi-application development._
